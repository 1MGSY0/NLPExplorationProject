{
  "stage": "bert_sentence_classifier",
  "config": {
    "backbone": "distilbert-base-uncased",
    "train_articles": 2000,
    "val_articles": 400,
    "test_articles": 400,
    "rouge_label_threshold": 0.35,
    "top_k_sentences": 3,
    "decision_threshold": 0.5,
    "max_seq_len": 160,
    "batch_size": 16,
    "learning_rate": 2e-05,
    "weight_decay": 0.01,
    "max_epochs": 1,
    "warmup_ratio": 0.1,
    "grad_accum": 2,
    "dev_mode": true,
    "device": "cuda",
    "seed": 42
  },
  "training_time_seconds": 3922.507668495178,
  "train_history": [
    {
      "epoch": 1,
      "loss": 0.11072115949861715
    }
  ],
  "val_history": [
    {
      "epoch": 1,
      "precision": 0.0,
      "recall": 0.0,
      "f1": 0.0
    }
  ],
  "test_metrics": {
    "precision": 0.16666666666666666,
    "recall": 0.001,
    "f1": 0.001988071570576541,
    "bleu": 10.20565908530916,
    "rouge1": 33.23893505834671,
    "rouge2": 12.604633828445126,
    "rougeL": 22.337271151892274,
    "meteor": 28.520560211136768
  },
  "samples": [
    {
      "article_id": "f00ae3c3929d829cd469ba4f229cc613b0766203",
      "highlights": "the comedian stayed with flavours who offer a painting in venice break . jenny and her partner geof stayed at the farmhouse villa bianchi . days involved sitting in medieval market towns with a brush and prosecco .",
      "predicted_summary": "comedian jenny eclair travelled with her other half on a painting in venus break with flavours . flavours (flavoursholidays.co.uk, 0131 343 2500) offers a seven-night full-board painting in venice break from 1,599pp, including wine with meals, five days of tuition, excursions, and 100 towards flight costs. british airways (ba.com) offers return flights to venice from heathrow, gatwick and london city from 77pp.",
      "top_sentence_indices": [
        0,
        51,
        52
      ],
      "probabilities": [
        0.15256276726722717,
        0.09447405487298965,
        0.25099414587020874
      ]
    },
    {
      "article_id": "9e451f79499e5c784222b3f237c6ae4829849d79",
      "highlights": "the federal government will give shoshana hebshi 40,000 as compensation for being ethnically profiled . hebshi, who has a jewish mother and saudi arabian father, has said she was discriminated against based on her dark complexion . hebshi was detained along with two indian men she was seated next to . 'people do not forfeit their constitutional rights when they step onto an airplane,' said aclu attorney rachel goodman .",
      "predicted_summary": "the federal government will give shoshana hebshi 40,000 as compensation for being humiliated on the 10th anniversary of the 9 11 terrorist attacks after armed agents forced her from a plane at detroit metropolitan airport, made her undress during a search and held her for hours. yoga instructor: hebshi works as a freelance writer, yoga instructor, and is a mother to two twins . ethnically profiled: shoshana hebshi, a woman of arab and jewish descent was strip-searched at detroit metropolitan airport on the 10th anniversary on 9 11 .",
      "top_sentence_indices": [
        1,
        4,
        16
      ],
      "probabilities": [
        0.11967968940734863,
        0.11281131953001022,
        0.20102207362651825
      ]
    },
    {
      "article_id": "dae58055bd50598b93a230aa3a58e0d2f519b536",
      "highlights": "novak djokovic beat andy murray 7-6 4-6 6-0 in miami open 2015 final . djokovic lost his cool after losing the second set to the brit in florida . world no 1 djokovic shouted at his support team next to a scared ball boy . after seeing the replay, the serbian posted an apology video on facebook . click here for all the latest news from the world of tennis .",
      "predicted_summary": "novak djokovic issued an apology via facebook to a ball boy he frightened during the miami open . djokovic raises his arms after claiming victory over murray 7-6 4-6 6-0 in the miami open final on sunday . djokovic kisses the tophy for the title he's now won five times after beating murray, who is now world no 3 .",
      "top_sentence_indices": [
        3,
        23,
        25
      ],
      "probabilities": [
        0.2619512975215912,
        0.24048344790935516,
        0.199789896607399
      ]
    },
    {
      "article_id": "c05bda9b387ec8ae43803170b6f59b4b82505db9",
      "highlights": "most of those released were women and children . freed yazidis sent to capital of iraq's kurdish region .",
      "predicted_summary": "reports emerged from some yazidi survivors that isis raped and enslaved female yazidi captives. the u.s. state department estimates that 500,000 yazidis live in northern iraq, accounting for less than 1 of the country's population.",
      "top_sentence_indices": [
        14,
        18,
        19
      ],
      "probabilities": [
        0.0812605693936348,
        0.4418039619922638,
        0.1367616504430771
      ]
    },
    {
      "article_id": "5c7493c6f28cfd58aa7b5f0e486e611307b4126d",
      "highlights": "second modified, armored van spotted near des moines, iowa alongside the one that hillary clinton travels in . visually identical black vehicles' biggest difference is the color of their new york license plates . one is a chevy and the other a gmc but they are mechanically identical and one was seen using secret service-fitted red and blue lights . van dubbed 'scooby' in homage to the scooby-doo cartoon show brought clinton to iowa from her new york house . 'scooby-two' made its debut in norwalk, iowa on wednesday outside a fruit processing plant where clinton made a scripted appearance .",
      "predicted_summary": "hillary clinton climbs into the so-called scooby van after a campaign stop at capital city fruit in norwalk, iowa . flashers: 'scooby-two' forced an iowa motorist to leave the roadway on wednesday so it could go through a red light and rejoin the caravan . the stray car s driver pulled to one side and scooby-two zoomed into the intersection, against the light .",
      "top_sentence_indices": [
        10,
        17,
        28
      ],
      "probabilities": [
        0.14238102734088898,
        0.2485732138156891,
        0.14039835333824158
      ]
    },
    {
      "article_id": "bc42c6d33bf59c3b4d87e834927605b90eadb935",
      "highlights": "tim swiel spent four months on loan at harlequins earlier this season . the 23-year-old featured in the european champions cup and lv cup . the fly-half will return to the club on a full-time contract next season .",
      "predicted_summary": "harlequins have announced that fly-half tim swiel will return to the club next season on a full-time contract. swiel, 21, spent four months on loan with quins earlier this term before heading back to the durban-based sharks in south africa. tim swiel will return to h .",
      "top_sentence_indices": [
        0,
        1,
        3
      ],
      "probabilities": [
        0.3612206280231476,
        0.21500147879123688,
        0.19973814487457275
      ]
    },
    {
      "article_id": "16b22d0148fef4baa24dcc330b6ac81a363c0f1e",
      "highlights": "the project accidentally mistook one african-american comic for another . they used footage of jay pharoah when promoting michael che interview . viewers of twitter were quick to point out the embarrassing mix-up . presenter waleed aly apologised for the mistake later in the program . ironically, aly was the subject of a strikingly similar mix-up this year .",
      "predicted_summary": "channel ten show the project has apologised after mistakenly using footage of the wrong african-american comic when promoting upcoming guest on the show, saturday night live star michael che. che and pharoah are both in australia to perform a string of shows at melbourne s international comedy festival. the age incorrectly printed a photo of 'legally brown' comedy star nazeem hussain in its entertainment column in january with the caption: 'waleed aly joins the project'.",
      "top_sentence_indices": [
        0,
        2,
        18
      ],
      "probabilities": [
        0.1337084025144577,
        0.19197750091552734,
        0.13582313060760498
      ]
    },
    {
      "article_id": "4dc06ca396df68b214798dc92c31808ab0dcb87a",
      "highlights": "liverpool lost 2-1 to aston villa in the fa cup semi-final at wembley . steven gerrard's dream of making the fa cup final were shattered . gerrard started the game in an advanced role behind raheem sterling . the first half largely passed gerrard by at wembley . the reds midfielder, however, almost snatched an equaliser at the death .",
      "predicted_summary": "steven gerrard's hopes of a fairytale ending to his liverpool career were shattered as his side suffered a 2-1 defeat to aston villa in the semi-finals of the fa cup. liverpool midfielder steven gerrard (left) competes for posession with kieran richardson . gerrard leaves the pitch following his side's 2-1 fa cup semi-final defeat by villa .",
      "top_sentence_indices": [
        0,
        3,
        19
      ],
      "probabilities": [
        0.12708935141563416,
        0.2724669277667999,
        0.2780478298664093
      ]
    },
    {
      "article_id": "b39341c062db854a18fefb0f100976103705a086",
      "highlights": "morrissey wrote a letter to australian retailer the just group . they own just jeans, dotti, portmans, jay jays, and peter alexander . the group have so far refused to stop selling controversial angora wool . singer to ask audience at sydney concert to sign petition against company . morrissey has also banned the sale of meat products at opera house . myer, david jones, sportsgirl among those who've agreed to angora ban .",
      "predicted_summary": "brutal: peta have successfully petitioned a number of australian and international retailers to stop selling angora wool after revealing the horrific treatment of rabbits at chinese angora farms . protest: morrissey, 55, pledged to set up petition booths for attendees at his sydney concerts to sign if the just group do not comply . in concert: the irish-born musician has also banned the sale of meat products at the opera house for the duration of his residency for the vivid festival in may .",
      "top_sentence_indices": [
        5,
        15,
        20
      ],
      "probabilities": [
        0.35493963956832886,
        0.2789373993873596,
        0.35409289598464966
      ]
    },
    {
      "article_id": "9a953efc47ed0dd24bfd495e56c273f6d370aad6",
      "highlights": "manny pacquiao faces floyd mayweather in 300m showdown on may 2 . pac-man has released own entrance song 'lalaban ako para sa filipino' the 36-year-old also directed the music video ahead of las vegas clash .",
      "predicted_summary": "the boxing champion's song 'lalaban ako para sa filipino' translates as 'i will fight for the fillipino' the 80s style music video includes a montage of pacquiao's fights and his humanitarian efforts . pacquiao recently unveiled the multicoloured mouth guard he will wear during his 300million las vegas showdown with mayweather. pacquiao has revealed the colourful mouthpiece he will wear during the may 2 bout in las vegas .",
      "top_sentence_indices": [
        8,
        11,
        14
      ],
      "probabilities": [
        0.12965214252471924,
        0.1557220071554184,
        0.21124610304832458
      ]
    }
  ]
}